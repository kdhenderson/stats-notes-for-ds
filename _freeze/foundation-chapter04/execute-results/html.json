{
  "hash": "d2206c0e5749267a97012552a0f3ee97",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Type I, Type II Error, and Power\"\n---\n\n\n\n\n## Objectives\n\n- Define and distinguish between Type I error, Type II error, and statistical power.\n- Explain how effect size, sample size, and significance level influence power.\n- Calculate power or required sample size using R or SAS.\n- Create and interpret power curves to communicate trade-offs in study design.\n\n\n## Helpful Resources\n\n- [Interactive Power Applet](https://statsthroughsimulation.shinyapps.io/PowerApplet/)\n- [SAS Power and Sample Size Documentation](https://support.sas.com/documentation/onlinedoc/stat/141/power.pdf)\n\n\n## Hypothesis Test Errors and Outcomes\n\n### Type I Error\n- If the null hypothesis ($H_0$) is true, the test is correct when it **fails to reject** $H_0$.\n- Rejecting $H_0$ when it is true is a **Type I error**, with a probability equal to $\\alpha$.\n- The critical value determines the rejection region. If $\\bar{x}$ falls on the $H_0$ side, the test fails to reject.\n- There is an $\\alpha$% chance that $H_0$ is true and $\\bar{x}$ is as extreme or more extreme than the critical value, leading to a Type I error.\n\n\n### Type II Error\n- If $H_0$ is false, the test is correct when it **rejects** $H_0$.\n- Failing to reject $H_0$ when it is false is a **Type II error**, with a probability equal to $\\beta$.\n\n### Hypothesis Test Outcome Matrix\nThe following matrix summarizes the four possible outcomes of a hypothesis test, highlighting the probabilities of Type I error ($\\alpha$), Type II error ($\\beta$), and power ($1 - \\beta$).  \n  \n<div style=\"max-width: 400px; margin: auto; text-align: center;\">\n$$\n\\begin{array}{|c|c|c|}\n\\hline\n& H_0\\ \\textbf{True} & H_0\\ \\textbf{False} \\\\ \\hline\n\\textbf{Reject } H_0 & \\text{Type I error } (\\alpha) & \\text{✅ Power } (1 - \\beta) \\\\ \\hline\n\\textbf{FTR } H_0 & \\text{✅ Correct} & \\text{Type II error } (\\beta) \\\\ \\hline\n\\end{array}\n$$\n\n<div style=\"font-size: 0.9em; line-height: 1.2em; text-align: center;\">\n<em>*Matrix of hypothesis test outcomes based on the truth of $H_0$ and the decision to reject or not reject.*</em>\n</div>\n</div>\n\n\n## Power\n\n- Power is the probability of correctly rejecting $H_0$ when it is false ($1 - \\beta$).\n- It measures the test's ability to detect true differences between population distributions.\n- Higher power means a greater likelihood of detecting a real effect.\n\nExample power statement: \"At [power level]% power, this study can detect an effect size of $\\Delta$ or larger at $\\alpha$ = [significance level] with $n$ = [sample size].\"\n\n\n## Effect Size\n\n- Effect size is the difference between the null mean and the true mean.\n- Example: If the null mean is 50 and the true mean is 60, the raw effect size is 10.\n- **Cohen’s *d*** is a standardized measure of effect size:\n  $$\n  d = \\frac{\\text{raw effect size}}{\\text{standard deviation}} = \\frac{\\mu_1 - \\mu_0}{\\sigma}\n  $$\n  - It normalizes the difference between the means using the standard deviation.\n- Increasing effect size increases power and decreases $\\beta$, but it does not affect the critical value or $\\alpha$.\n- Power and the probability of a Type II error depend on the actual value of $\\mu$.\n\n![**Sampling Distributions, Power, and Effect Size.** \nThis diagram illustrates the relationship between effect size, critical values, power, and Type I and Type II errors. Narrower distributions from larger sample sizes improve the ability to detect true differences.](images/fch04_errors_and_power.png){fig-align=\"center\"}\n\n\n## How to Increase Power\n\n- **Increase effect size**: Larger differences are easier to detect.\n- **Increase $\\alpha$**: A less stringent threshold makes rejection more likely. Increasing $\\alpha$ makes the critical value less extreme, making it easier for the test statistic to exceed it, thus increasing the chance of rejecting $H_0$.\n- **Increase sample size**: Larger samples reduce variability in $\\bar{x}$, making it more likely to be close to $\\mu$ and increasing the likelihood of detecting true effects.\n\n> **Note**: If power is close to $\\beta$, the chances of detecting a difference or making a Type II error are similar. This may occur when the effect size is small. Increasing the sample size can help.\n\n\n## Balancing Type I and Type II Errors\n\n- Reducing $\\alpha$ decreases the probability of a Type I error but increases the probability of a Type II error.\n- There is often a trade-off between these two error types, so both should be considered in study design.\n\n\n## Example Code For Finding Power or Other Missing Parameters\n\nR code:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n## Missing parameter is indicated with `NULL`\n\n# One-sample t-test power calculation\npower.t.test(n = 41, delta = .07, \n             sd = 0.2, sig.level = 0.05,\n             power = NULL, \n             type = \"one.sample\", alternative = \"one.sided\")\n\n# Two-sample t-test example\npower.t.test(n = 250, delta = 5,\n             sd = 25, sig.level = 0.05, \n             power = NULL, \n             type = \"two.sample\", alternative = \"one.sided\")\n```\n:::\n\n\n\n\nSAS code:\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\n/* Missing parameter is indicated with a period */\n\n/* One-sample t-test */\nproc power;\n\tonesamplemeans\n\t\tsides = 1\n\t\talpha = 0.1\n\t\tnullmean = 20000\n\t\tmean = 20450\n\t\tstddev = 500\n\t\tntotal = 8\n\t\tpower = .;  /* parameter to solve for */\nrun;\n\n/* Two-sample t-test */\nproc power;\n*can specify mean for each (nullmean) and ntotal;\t\n\ttwosamplemeans\n\t\tsides = 1\n\t\talpha = 0.05\n\t\tmeandiff = 4\n\t\tstddev = 3\n\t\tnpergroup = 50\n\t\tpower = .;  /* parameter to solve for */\nrun;\t\t\n\t\t\n```\n:::\n\n\n\n\n\n## Example Code For Creating a Power Curve\n\nR code:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loop to calculate power for sample sizes from 60 to 80\npowerholder = c()\nsamplesizes = seq(60, 80, by = 1)\n\nfor(i in 1:length(samplesizes)) {\n  powerholder[i] = power.t.test(n = samplesizes[i], delta = 0.07, sd = 0.20, sig.level = 0.05,\n                                type = \"one.sample\", alternative = \"one.sided\")$power\n}\n\n# Create a data frame\npowerdf = data.frame(samplesizes, powerholder)\n\n# Plot the power curve\npowerdf %>% \n  ggplot(aes(x = samplesizes, y = powerholder)) +\n  geom_line(color = \"blue3\", linewidth = 1.5) +\n  ggtitle(\"Power Curve\") +\n  ylab(\"Power\") +\n  xlab(\"Sample Size\") +\n  ylim(0.75, 1.0) +\n  theme_bw()\n```\n:::\n\n\n\n\nSAS code:\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\n/* Power curve for different sample sizes */\nods graphics on;\n\nproc power;\n\tonesamplemeans\n\t\tsides = 1\n\t\talpha = 0.05\n\t\tnullmean = 0\n\t\tntotal = 60 80\n\t\tmean = 0.07\n\t\tstddev = 0.2\n\t\tpower = .;  /* parameter to solve for */\n\t\tplot x = n min = 60 max = 80;\nrun;\n\nods graphics off;\n\n/* Power curve for different effect sizes */\nods graphics on;\n\nproc power;\n\ttwosamplemeans\n\t\tsides = 1\n\t\talpha = 0.05\n\t\tnulldiff = 0\n\t\tmeandiff = 3 to 5 by 0.1 \n\t\tntotal = 47\n\t\tstddev = 4.5\n\t\tpower = .;  /* parameter to solve for */\n\t\tplot x = effect min = 3 max = 5;\nrun;\n\nods graphics off;\n\n```\n:::\n\n\n\n\n\n## Summary of Start-to-Finish Analysis for Client Presentation\n\n### Initial Meetings & Research Planning Phase\n- Define key parameters, such as desired power (e.g., at least 80%).\n- Conduct a power analysis to determine required sample sizes for different power thresholds.\n- Provide multiple design options based on budget and desired power.\n- Create power curves to visualize trade-offs between sample size and power.\n\n### Final Presentation & Results Communication\n- Restate the research question and test parameters.\n- Display descriptive statistics and plots (e.g., boxplots, histograms).\n- Present test results, including *p*-values and confidence intervals.\n- Include a summary of assumptions and a six-step test outline in the appendix.\n- Share contact information for follow-up.\n",
    "supporting": [
      "foundation-chapter04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}